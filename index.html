<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>PCA</title>
    <meta charset="utf-8" />
    <meta name="author" content="Antoine Lachance-Perreault" />
    <meta name="date" content="2022-06-03" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="promu_theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# PCA
]
.subtitle[
## Rendez-vous Analytique 2022
]
.author[
### Antoine Lachance-Perreault
]
.date[
### 2022-06-03
]

---











# Classification de la méthode

--

* Méthode non supervisée

  * Utilise la structure des données et non une variable réponse
  * `\(\{x_1,x_2,...,x_n\}\rightarrow\{PC_1,PC_2,...,PC_n\}\)`

--

* Réduction de la dimensionnalité

  * `\(\{x_1,x_2,...,x_n\}\rightarrow\{PC_1,PC_2\}\)`

--

* Pourquoi?

  * Visualisation
  * Modélisation
  * Comprendre les corrélations entre les données

???

Visualisation: On ne peut pas faire un graphique à 10 variables, mais si on peut réduire nos 10 variables en 2 principal components qui résument leur effets, c'est plus gérable pour visualiser la donné

Modélisation: 2000 variables, mais 1000 observations, peut nécessiter de réduire le nombre de variables pour fitter un modèle


---

# Fonctionnement de la méthode

Le jeu de données:

.left-column[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; obs &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; a &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; b &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.169 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2.282 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.347 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1.140 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.847 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2.285 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.894 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1.969 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1.347 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2.225 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3.208 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2.636 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 4.089 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3.499 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 4.713 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3.728 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

.right-column[

&lt;img src="media/images/pca_viz/initial_data_ManimCE_v0.15.1.png" width="700px" style="display: block; margin: auto;" /&gt;

]

???

On va maintenant regarder les différentes étapes nécessaire pour créer les principal components à partir de ces deux variables

---

class: center middle
# 1. Centrer et réduire les variables

???
Avant de commencer à appliquer la méthode, on va faire 2 transformations au data, 
pour des raisons que je vais aborder plus tard

---

&lt;video width="100%" height="100%" id="bg_vid"&gt;
    &lt;source src="media/videos/pca_viz/2160p60/center_points.mp4"&gt;
&lt;/video&gt;

???
La première transformation est de centrer les variables, donc les ajuster pour qu'elles aient toutes une moyenne de 0

---

&lt;video width="100%" height="100%" id="bg_vid"&gt;
    &lt;source src="media/videos/pca_viz/2160p60/scale_points.mp4"&gt;
&lt;/video&gt;

???

La deuxième est de réduire les variables, donc on les modifient pour qu'elles aient un écart type de 1

---

# Résultat

&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; a &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; b &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; a' &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; b' &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;border-left:1px solid;"&gt; 0.169 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2.282 &lt;/td&gt;
   &lt;td style="text-align:center;border-left:1px solid;"&gt; -1.000 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.227 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;border-left:1px solid;"&gt; 0.347 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1.140 &lt;/td&gt;
   &lt;td style="text-align:center;border-left:1px solid;"&gt; -0.901 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -1.604 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;border-left:1px solid;"&gt; 0.847 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2.285 &lt;/td&gt;
   &lt;td style="text-align:center;border-left:1px solid;"&gt; -0.620 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.223 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;border-left:1px solid;"&gt; 0.894 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1.969 &lt;/td&gt;
   &lt;td style="text-align:center;border-left:1px solid;"&gt; -0.594 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.605 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;border-left:1px solid;"&gt; 1.347 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2.225 &lt;/td&gt;
   &lt;td style="text-align:center;border-left:1px solid;"&gt; -0.339 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.296 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;border-left:1px solid;"&gt; 3.208 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2.636 &lt;/td&gt;
   &lt;td style="text-align:center;border-left:1px solid;"&gt; 0.705 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.200 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;border-left:1px solid;"&gt; 4.089 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3.499 &lt;/td&gt;
   &lt;td style="text-align:center;border-left:1px solid;"&gt; 1.199 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1.240 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;text-decoration: underline;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;text-decoration: underline;border-left:1px solid;"&gt; 4.713 &lt;/td&gt;
   &lt;td style="text-align:center;text-decoration: underline;"&gt; 3.728 &lt;/td&gt;
   &lt;td style="text-align:center;text-decoration: underline;border-left:1px solid;"&gt; 1.550 &lt;/td&gt;
   &lt;td style="text-align:center;text-decoration: underline;"&gt; 1.515 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Moyenne &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;border-left:1px solid;"&gt; 1.952 &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;"&gt; 2.470 &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;border-left:1px solid;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;"&gt; 0.000 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Écart type &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;border-left:1px solid;"&gt; 1.782 &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;"&gt; 0.830 &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;border-left:1px solid;"&gt; 1.000 &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;"&gt; 1.000 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

class: center middle
# 2. Trouver les « principal components »

---

# Idée générale

&lt;video width="100%" height="100%" id="bg_vid"&gt;
    &lt;source src="media/videos/pca_viz/2160p60/pca_idee_gen.mp4"&gt;
&lt;/video&gt;



&lt;!-- 


  Comme j'ai mentionné précédemment, la PCA est une méthode de réduction de la dimensionnalité, donc on cherche à éliminer des variables pour en garder seulement quelques unes significative, tout en gardant l'information importante des variables initialles.
    
    
    
  Pour arriver à cela, on va trouver un nouveau système d'axes où on va chercher à maximiser l'information contenu dans chaque axe
    De cette façon, les derniers axes auront moins d'information et pourront potentiellement être ignorés
    
  Cette information va être mesurée par la distance au carré de chaque point sur l'axe
    On utilise la distance au carré pour ne pas qu'une distance négative en annule une positive
  
    C'est aussi pour cette raison qu'il est très important de centrer et réduire notre data
      Si on a une variable qui est de 0 à 1 et une autre de 0 à 10000, le fait de prendre la distance au carré sans 
      centrer et réduire ferait que la plus grosse variable aurait une beaucoup trop grosse influence sur le principal component     

    Donc ici pour notre axe des X de départ, on peut voir que le point le plus loins est à 2.4... SWITCH
--&gt;



---

background-image: url("media/images/pca_viz/distance_vis0_ManimCE_v0.15.1.png")
background-position: center
background-size: contain

&lt;!---
&lt;video width="100%" height="100%" id="bg_vid"&gt;
    &lt;source src="media/videos/pca_viz/2160p60/pca_init.mp4"&gt;
&lt;/video&gt;
---&gt;

---

&lt;video width="100%" height="100%" id="bg_vid"&gt;
    &lt;source src="media/videos/pca_viz/2160p60/project_points.mp4"&gt;
&lt;/video&gt;

---

&lt;video width="100%" height="100%" id="bg_vid"&gt;
    &lt;source src="media/videos/pca_viz/2160p60/distance_vis1.mp4"&gt;
&lt;/video&gt;

---

&lt;video width="100%" height="100%" id="bg_vid"&gt;
    &lt;source src="media/videos/pca_viz/2160p60/distance_vis2.mp4"&gt;
&lt;/video&gt;

---


&lt;video width="100%" height="100%" id="bg_vid"&gt;
    &lt;source src="media/videos/pca_viz/2160p60/tot_distance_calc.mp4"&gt;
&lt;/video&gt;

---

&lt;video width="100%" height="100%" id="bg_vid"&gt;
    &lt;source src="media/videos/pca_viz/2160p60/pc1_find.mp4"&gt;
&lt;/video&gt;

---

&lt;video width="100%" height="100%" id="bg_vid"&gt;
    &lt;source src="media/videos/pca_viz/2160p60/pc1_set.mp4"&gt;
&lt;/video&gt;

???

Maintenant qu'on a le premier PC, on s'attaque au 2e

Dans ce cas à 2 dimensions, la solution est triviale parce que les principal components doivent toujours être perpendiculaires les uns les autres, donc seulement un possible

---

&lt;video width="100%" height="100%" id="bg_vid"&gt;
    &lt;source src="media/videos/pca_viz/2160p60/pc2_find.mp4"&gt;
&lt;/video&gt;

---

&lt;video width="100%" height="100%" id="bg_vid"&gt;
    &lt;source src="media/videos/pca_viz/2160p60/rotate_axes.mp4"&gt;
&lt;/video&gt;

---

&lt;video width="100%" height="100%" id="bg_vid"&gt;
    &lt;source src="media/videos/pca_viz/2160p60/calc_ssd_pc.mp4"&gt;
&lt;/video&gt;

---

&lt;video width="100%" height="100%" id="bg_vid"&gt;
    &lt;source src="media/videos/pca_viz/2160p60/reduce_dim.mp4"&gt;
&lt;/video&gt;

---

class: center middle
# Un exemple pratique

---

# Le jeu de données

&lt;img src="media/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# Résultat de l'application


&lt;img src="media/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# Résultat de l'application

&lt;img src="media/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# Visualisation des résultats
&lt;img src="media/unnamed-chunk-8-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---


# Visualisation des résultats

&lt;img src="media/unnamed-chunk-9-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---


# Visualisation des résultats - Montréal

&lt;img src="media/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;" /&gt;


---

# Visualisation des résultats - Québec

&lt;img src="media/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

class: center middle
# Questions?











    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<script type='text/javascript'>

    var slideElements
    
      function getElementForSlide(slide) {
        slideElements = slideElements || document.querySelectorAll('.remark-slide')
        return slideElements[slide.getSlideIndex()]
      }
    
      slideshow.on('showSlide', function (slide) {
        Array.from(getElementForSlide(slide).querySelectorAll('video, audio')).forEach(function (vid) {
          vid.loop = false
          vid.currentTime = 0
          vid.play()
        })
      })
    
      slideshow.on('hideSlide', function (slide) {
        Array.from(getElementForSlide(slide).querySelectorAll('video, audio')).forEach(function (vid) {
          vid.pause()
        })
      })
    
    </script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
